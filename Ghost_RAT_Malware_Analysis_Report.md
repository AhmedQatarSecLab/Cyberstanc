from pathlib import Path

# Compose the full malware analysis report based on all previously discussed information
full_report = """
# ü¶† Ghost RAT Malware Analysis Report

---

## üìÑ Report Overview

This report presents a comprehensive analysis of **Ghost RAT**, a Remote Access Trojan attributed to **APT17**, a Chinese state-sponsored threat group.  
The malware was analyzed in a secure, isolated lab environment using **Wireshark** and **Vortex** (powered by Cyberstanc).  
This analysis includes static and dynamic behavior, IOCs, DLL/API usage, and inferred threat capabilities.

---

## üß† Threat Summary

Ghost RAT is a classic espionage tool used in **state-sponsored cyber attacks** against:

- üèõÔ∏è Government institutions  
- üõ°Ô∏è Military systems  
- ‚ö° Critical infrastructure  
- üß† Political organizations

It is capable of stealthy persistence, remote access, privilege escalation, and system manipulation.

---

## üß™ Lab Environment

- **Execution Platform**: VMware (isolated VM)
- **Network Monitoring**: Wireshark
- **Malware Source**: MalwareBazaar
- **Behavioral Analysis Tool**: Vortex by Cyberstanc

---

## üîç Static Analysis

- **File Name**: `b25d4a715168af6c3f1ba9cbbae511ee7d11afd4b3aaf87c2a16a4411cd4bd8.exe`
- **File Type**: PE32 (GUI) Intel 80386, for MS Windows
- **Size**: 0.17 MB
- **MIME Type**: application/x-dosexec

**Hashes**:
- **MD5**: `c355d38cb7cb1f173a2223d1c6c686f`
- **SHA-1**: `f60lc09e013d4f51e4b69812b5c8c8615f5cba8`
- **SHA-256**: `b25d4a715168af6c3f1ba9cbbae511ee7d11afd4b3aaf87c2a16a4411cd4bd8`
- **TLSH**: `T120048C02BBC740F9EA68113C14B3776963BAD986B095FDA318EE755833151E633247`

---

## üóÇÔ∏è DLL & API Function Analysis

| **DLL**        | **Functions (Examples)**                                               | **Purpose**                                                                 |
|----------------|------------------------------------------------------------------------|------------------------------------------------------------------------------|
| `ole32.dll`    | `CoCreateGuid`, `CoInitialize`                                         | Initializes COM services and GUID creation                                  |
| `MSVCRT.dll`   | `malloc`, `fopen`, `fwrite`, `sprintf`                                 | Standard C library for memory, strings, and file I/O                        |
| `USER32.dll`   | `CreateWindowExA`, `MessageBoxW`                                       | GUI and message handling                                                    |
| `SHELL32.dll`  | `ShellExecuteA`                                                        | Executes programs via Windows Shell                                         |
| `ADVAPI32.dll` | `RegOpenKeyExA`, `AdjustTokenPrivileges`                               | Registry access and privilege management                                    |
| `KERNEL32.dll` | `CreateProcessA`, `OpenProcess`, `WriteFile`, `Sleep`, `GetTickCount`  | Core system operations and anti-debugging                                   |

---

## üö® Indicators of Compromise (IOCs)

| **IOC**                         | **Namespace**                                      | **Description**                               |
|----------------------------------|----------------------------------------------------|-----------------------------------------------|
| Inject DLL / thread             | host-interaction/process/inject                    | Memory code injection                          |
| Create Mutex                    | host-interaction/mutex                             | Avoids multiple executions                     |
| Modify Service                  | host-interaction/service/modify                    | Persistence via system services                |
| Query Registry                  | host-interaction/registry                          | Access to system config                        |
| Reference Base64 / XOR          | data-manipulation/encoding                         | Data obfuscation                               |
| Anti-VM / Sandbox Detection     | anti-analysis/anti-vm/vm-detection                 | Environment evasion                            |
| Create Directory, Delete File   | host-interaction/file-system/*                     | Payload handling and log cleanup               |

---

## üé• Lab Demonstration

üîó [Watch Ghost RAT Lab Video](https://drive.google.com/file/d/1w2KuczLkKZIVF_t1WKmg0caVo24IfAeN/view?usp=drive_link)

---

## üß† Conclusion

Ghost RAT demonstrates advanced capabilities in stealth, persistence, evasion, and remote control ‚Äî making it a high-risk tool used in cyber-espionage.  
The use of **Vortex** provided rich behavioral insights that validated the malware‚Äôs threat profile.

---

## üôè Acknowledgment

Special thanks to **Cyberstanc** for access to Vortex, and to **Rohit Bankoti** for the opportunity to work hands-on with advanced threat analysis.

**Stay curious. Stay safe. Stay ahead.**
"""

# Save the report to a markdown file
report_path = Path("/mnt/data/Ghost_RAT_Malware_Analysis_Report_Complete.md")
report_path.write_text(full_report)

report_path.name
